import{_ as q,r as T,c as J,o as Q,L as S,a as d,b as p,d as a,e as X,f,w as h,n as W,t as v,v as K,F as _,g as k,u as Z,h as C,i as E}from"./app-77DqzGmw.js";const ee={class:"bg-white shadow-lg max-w-4xl mx-auto p-6 mt-6 rounded-md text-[14px]"},te={class:"relative w-2/3 mx-auto mb-4"},ae={class:"absolute top-full left-0 w-full flex justify-between text-xs text-gray-700 -mt-1 pointer-events-none"},ie={class:"grid grid-cols-2 md:grid-cols-3 gap-y-3 gap-x-4 mb-6 text-gray-800 max-w-xl mx-auto"},se={class:"col-span-full mt-2 mb-1 flex items-center font-bold text-base"},oe=["disabled","value"],le=["title"],re={class:"col-span-full mt-4 mb-1 flex items-center font-bold text-base"},ne=["disabled","value"],ue=["title"],ce={class:"flex flex-col items-center mt-6 text-sm text-gray-800"},de={class:"flex justify-center space-x-4"},y=2e3,m=2022,L=2050,pe={__name:"CountryMap",setup(me){const r=T(["gmi_score"]),u=T(m),G=Array.from({length:L+1-y},(o,e)=>y+e),P=J(()=>`calc(${(u.value-y)/(L-y)*100}% - 1.5rem)`),$={gmi_score:"Composite index measuring the overall militarisation level of a country.",milex_indicator:"Index based on military expenditure in relation to GDP and health spending.",personnel_indicator:"Index based on the number of military personnel per capita.",weapons_indicator:"Index based on the volume of heavy weapons in armed forces.",wri_score:"Composite index reflecting a country s disaster risk due to natural hazards.",wri_exposure:"Degree to which a country is exposed to natural hazards.",wri_vulnerability:"Societal susceptibility and capacity to cope with disasters.",wri_susceptibility:"Structural vulnerability of a country (e.g., infrastructure, health).",wri_coping_capacity:"Short-term capabilities to reduce negative disaster impacts.",wri_adaptive_capacity:"Long-term capacity to adapt and transform in response to risks."},D=[{label:"Militarisation Index",value:"gmi_score"},{label:"Military Expenditure Index",value:"milex_indicator"},{label:"Military Personnel Index",value:"personnel_indicator"},{label:"Heavy Weapons Index",value:"weapons_indicator"}],j=[{label:"World Risk Index",value:"wri_score"},{label:"Exposure",value:"wri_exposure"},{label:"Vulnerability",value:"wri_vulnerability"},{label:"Susceptibility",value:"wri_susceptibility"},{label:"Coping Capacity",value:"wri_coping_capacity"},{label:"Adaptive Capacity",value:"wri_adaptive_capacity"}];function B(o){const e=o==="gmi"?"gmi_score":"wri_score",t=o==="gmi"?D:j;r.value.includes(e)&&t.forEach(l=>{l.value!==e&&(r.value=r.value.filter(i=>i!==l.value))}),w()}function z(o){const e=o==="gmi"?"gmi_score":"wri_score";r.value.includes(e)&&(r.value=r.value.filter(t=>t!==e)),w()}let M=null,x={},A=null,b={},R={};const U=["#800026","#BD0026","#E31A1C","#FC4E2A","#FD8D3C"],F=["#08306B","#08519C","#2171B5","#4292C6","#6BAED6"];function H(){return u.value>m?F:U}const g=T([]);function N(o){const e=Object.values(o).filter(s=>typeof s=="number"),t=Math.min(...e),l=Math.max(...e),i={};for(const[s,n]of Object.entries(o))typeof n!="number"?i[s]=null:l===t?i[s]=.5:i[s]=(n-t)/(l-t);return i}function Y(){const o=Object.values(b).filter(l=>typeof l=="number");if(!o.length)return;o.sort((l,i)=>l-i);const e=[.2,.4,.6,.8].map(l=>o[Math.floor(l*o.length)]),t=H();g.value=[{color:t[0],label:"Top 20%",threshold:e[3]},{color:t[1],label:"60–80%",threshold:e[2]},{color:t[2],label:"40–60%",threshold:e[1]},{color:t[3],label:"20–40%",threshold:e[0]},{color:t[4],label:"Bottom 20%",threshold:-1/0},{color:"#ddd",label:"no data available",threshold:null}]}function O(o){if(o==null)return"#ddd";for(const e of g.value)if(e.threshold!=null&&o>=e.threshold)return e.color;return g.value[g.value.length-1].color}function V(o){if(u.value<=m)return"";const e=r.value.length===1?r.value[0]:null;if(!e)return"";const t=R[o];if(!t)return"";const l=t[`${e}_lo_ci`],i=t[`${e}_hi_ci`];return typeof l=="number"&&typeof i=="number"?`<br>CI (${e}): ${l.toFixed(2)} … ${i.toFixed(2)}`:""}async function w(){try{const o=r.value.join(","),t=await(await fetch(`/api/map-data?year=${u.value}&metrics=${o}`)).json();x={},t.forEach(i=>{const s=i.iso3?.toUpperCase();s&&(x[s]=i.source||(u.value>m?"predicted":"actual"))}),R={},t.forEach(i=>{const s=i.iso3?.toUpperCase();s&&(R[s]=i)});const l={};if(r.value.forEach(i=>{const s={};t.forEach(n=>{const c=n.iso3?.toUpperCase();s[c]=typeof n[i]=="number"?n[i]:null}),l[i]=N(s)}),b={},t.forEach(i=>{const s=i.iso3?.toUpperCase();s&&(r.value.length===0?b[s]=null:b[s]=r.value.reduce((n,c)=>{const I=l[c]?.[s]??null;return I!=null?n+I:n},0))}),Y(),A)A.eachLayer(i=>{const s=i.feature.properties.ADM0_A3,n=b[s];i.setStyle({fillColor:O(n)}),i.bindPopup(`<strong>${i.feature.properties.ADMIN}</strong><br>Score (${u.value}): ${n?.toFixed(2)??"no data"}<br>Source: ${x[s]??(u.value>m?"predicted":"actual")}`+V(s))});else{const i=await fetch("/geo/ne_countries.geojson").then(s=>s.json());A=S.geoJSON(i,{style:s=>{const n=s.properties.ADM0_A3,c=b[n];return{fillColor:O(c),weight:1,color:"#555",fillOpacity:.7}},onEachFeature:(s,n)=>{const c=s.properties.ADM0_A3,I=b[c];n.bindPopup(`<strong>${n.feature.properties.ADMIN}</strong><br>Score (${u.value}): ${I?.toFixed(2)??"no data"}<br>Source: ${x[c]??(u.value>m?"predicted":"actual")}`+V(c))}}).addTo(M)}}catch(o){console.error("Error refreshing map:",o)}}return Q(async()=>{try{M=S.map("map").setView([20,0],2),S.tileLayer("https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png",{attribution:"© OpenMapTiles © OpenStreetMap contributors"}).addTo(M),await w()}catch(o){console.error("Error initializing map:",o)}}),(o,e)=>(p(),d("div",ee,[e[15]||(e[15]=a("h1",{class:"text-2xl font-bold text-center mb-3 text-gray-800"}," Composite Risk Explorer: Global Militarisation & Climate Hazards ",-1)),e[16]||(e[16]=a("p",{class:"text-center text-gray-800 text-sm mb-6"},[f(" This interactive map allows you to combine indicators from the "),a("strong",null,"Global Militarisation Index (GMI)"),f(" and the "),a("strong",null,"World Risk Index (WRI)"),f(" by country and year. "),a("br"),f(" You can either select one composite index or freely combine individual indicators to explore patterns of militarisation and climate disaster vulnerability. Choose your indicators and a year to see the map update in real time. ")],-1)),e[17]||(e[17]=a("label",{for:"yearRange",class:"block mb-2 font-semibold text-center text-gray-800 text-lg"}," Year ",-1)),a("div",te,[a("div",{class:"absolute -top-6 bg-blue-100 text-blue-800 px-3 py-1 rounded shadow text-sm font-medium transition-all duration-200",style:W({left:P.value})},v(u.value),5),h(a("input",{id:"yearRange",type:"range",min:y,max:L,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),onInput:w,class:"w-full z-10 relative"},null,544),[[K,u.value]]),a("div",ae,[(p(!0),d(_,null,k(Z(G),t=>(p(),d("span",{key:t,class:"w-0 text-center"},v(t%5===0?t:""),1))),128))])]),a("div",ie,[a("label",se,[h(a("input",{type:"checkbox",class:"mr-2",value:"gmi_score","onUpdate:modelValue":e[1]||(e[1]=t=>r.value=t),onChange:e[2]||(e[2]=t=>B("gmi"))},null,544),[[C,r.value]]),e[9]||(e[9]=f(" Global Militarisation Index (GMI) ",-1)),e[10]||(e[10]=a("span",{class:"ml-1 cursor-help text-blue-900 text-xl",title:"The GMI measures the relative weight and importance of a country's military compared to its society."},"ⓘ",-1)),e[11]||(e[11]=a("a",{href:"#gmi-info",class:"ml-2 text-blue-800 text-xs"},"Read more ↓",-1))]),(p(!0),d(_,null,k(D.filter(t=>t.value!=="gmi_score"),t=>(p(),d("label",{key:t.value,class:E(["inline-flex items-center",r.value.includes("gmi_score")?"opacity-50 cursor-not-allowed":""])},[h(a("input",{type:"checkbox",disabled:r.value.includes("gmi_score"),"onUpdate:modelValue":e[3]||(e[3]=l=>r.value=l),value:t.value,onChange:e[4]||(e[4]=l=>z("gmi")),class:"mr-2"},null,40,oe),[[C,r.value]]),a("span",null,v(t.label),1),a("span",{class:"text-blue-600 cursor-help text-lg ml-1",title:$[t.value]},"ⓘ",8,le)],2))),128)),a("label",re,[h(a("input",{type:"checkbox",class:"mr-2",value:"wri_score","onUpdate:modelValue":e[5]||(e[5]=t=>r.value=t),onChange:e[6]||(e[6]=t=>B("wri"))},null,544),[[C,r.value]]),e[12]||(e[12]=f(" World Risk Index (WRI) ",-1)),e[13]||(e[13]=a("span",{class:"ml-1 cursor-help text-blue-900 text-xl",title:"The WRI combines exposure to natural hazards and vulnerability to assess disaster risk."},"ⓘ",-1)),e[14]||(e[14]=a("a",{href:"#wri-info",class:"ml-2 text-blue-800 text-xs"},"Read more ↓",-1))]),(p(!0),d(_,null,k(j.filter(t=>t.value!=="wri_score"),t=>(p(),d("label",{key:t.value,class:E(["inline-flex items-center",r.value.includes("wri_score")?"opacity-50 cursor-not-allowed":""])},[h(a("input",{type:"checkbox",disabled:r.value.includes("wri_score"),"onUpdate:modelValue":e[7]||(e[7]=l=>r.value=l),value:t.value,onChange:e[8]||(e[8]=l=>z("wri")),class:"mr-2"},null,40,ne),[[C,r.value]]),a("span",null,v(t.label),1),a("span",{class:"text-blue-600 cursor-help text-lg ml-1",title:$[t.value]},"ⓘ",8,ue)],2))),128))]),e[18]||(e[18]=a("div",{id:"map",style:{height:"600px","margin-top":"2rem"}},null,-1)),a("div",ce,[a("div",{class:E(["mb-2 font-medium",u.value>m?"text-blue-800":"text-amber-800"])},v(u.value>m?"Predicted (2023–2050)":"Observed (≤2022)"),3),a("div",de,[(p(!0),d(_,null,k(g.value,(t,l)=>(p(),d("div",{key:l,class:"flex items-center space-x-1"},[a("div",{style:W({backgroundColor:t.color}),class:"w-5 h-3 border border-gray-300"},null,4),a("span",null,v(t.label),1)]))),128))])]),e[19]||(e[19]=X('<div class="max-w-3xl mx-auto text-gray-900 text-sm mt-10" data-v-7514f21b><h2 class="text-lg font-semibold mt-6 mb-2" data-v-7514f21b>About the Global Militarisation Index (GMI)</h2><p class="mb-2" data-v-7514f21b> The GMI, published annually by the Bonn International Center for Conversion (BICC), reflects a country’s relative militarisation compared to its society. It combines data on military expenditures, personnel, and heavy weapons in relation to indicators like GDP or health spending. A high GMI score indicates that the military sector plays a disproportionately large role in a country’s resource allocation. </p><p class="mb-6" data-v-7514f21b><a href="https://gmi.bicc.de" target="_blank" class="text-blue-800 underline" data-v-7514f21b>Learn more about GMI at gmi.bicc.de ↗</a></p><h2 class="text-lg font-semibold mt-6 mb-2" data-v-7514f21b>About the World Risk Index (WRI)</h2><p class="mb-2" data-v-7514f21b> The WRI is published by the Bündnis Entwicklung Hilft and the Institute for International Law of Peace and Armed Conflict (IFHV) at Ruhr University Bochum. It measures the disaster risk for countries based on their exposure to natural hazards and their vulnerability, including susceptibility, coping capacity, and adaptive capacity. It is intended to support disaster risk reduction and climate adaptation planning. </p><p class="mb-6" data-v-7514f21b><a href="https://www.weltrisikobericht.de" target="_blank" class="text-blue-800 underline" data-v-7514f21b>Learn more about WRI at weltrisikobericht.de ↗</a></p><h2 class="text-lg font-semibold mt-6 mb-2" data-v-7514f21b>Reflections &amp; Further Work</h2><p class="mb-3" data-v-7514f21b>This project combines different global indicators to explore composite vulnerability profiles. It’s important to note that the <strong data-v-7514f21b>Mercator projection</strong> distorts geographic proportions — for example, countries near the poles appear larger. A future update might explore alternative, more realistic map projections.</p><p class="mb-3" data-v-7514f21b>This tool currently visualizes historical data, but in the future, one could apply <strong data-v-7514f21b>machine learning models</strong> to make forecasts about militarisation or climate risk under different scenarios. These projections would remain speculative and rely on underlying assumptions and data quality.</p><p class="mb-3" data-v-7514f21b>The combination logic here is based on <strong data-v-7514f21b>normalized summation</strong>. There may be other meaningful ways to weight or cluster indicators, such as using <strong data-v-7514f21b>principal component analysis (PCA)</strong> or <strong data-v-7514f21b>unsupervised clustering</strong> to identify country typologies. PCA helps reduce dimensionality by identifying underlying patterns across indicators, while clustering (e.g., k-Means) groups countries with similar vulnerability-militarisation profiles — which could be visualized or used to inform policy insights.</p><p class="mb-3" data-v-7514f21b>Accessibility improvements are also a future goal. While the current interface uses semantic HTML and simple controls, future work will include keyboard navigation support, ARIA landmarks, screen reader compatibility, and color palettes suitable for users with <strong data-v-7514f21b>color vision deficiency</strong>. This could be achieved through contrast-friendly palettes or visual textures in the map.</p><p class="mb-6" data-v-7514f21b>The application is not yet fully <strong data-v-7514f21b>responsive</strong>, which limits usability on mobile devices. Improving layout adaptability for smaller screens and touch interaction is a priority in the next iteration.</p><h2 class="text-lg font-semibold mt-6 mb-2" data-v-7514f21b>Tech Stack &amp; Repository</h2><p class="mb-2" data-v-7514f21b>This fullstack web app was built with <strong data-v-7514f21b>Laravel (PHP)</strong> and <strong data-v-7514f21b>Vue.js (Vite, TypeScript)</strong>, using <strong data-v-7514f21b>Inertia.js</strong> to bridge backend and frontend. Interactive geospatial visualization was implemented using <strong data-v-7514f21b>Leaflet.js</strong>. Data is served from a local SQLite database. Tailwind CSS powers the UI styling.</p><p class="mb-2" data-v-7514f21b>During deployment on <strong data-v-7514f21b>Heroku</strong>, special attention was paid to runtime stability, asset path resolution, and request proxy headers. Environment-specific adjustments were made to ensure the app remains accessible after build without database failures.</p><p class="mb-2" data-v-7514f21b>The application was developed with a strong focus on open data integration, intuitive interaction, and modular design. Based on the BICC’s work on militarisation and the WRI’s climate risk research, the tool creates space for both academic and public engagement.</p><p class="mb-6" data-v-7514f21b> GitHub Repository: <a href="https://github.com/ArtificialIntellicat/composite-risk-explorer-gmi-wri" target="_blank" class="text-blue-800 underline inline-flex items-center" data-v-7514f21b><svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" class="w-4 h-4 mr-1" data-v-7514f21b><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.387.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.612-4.042-1.612-.546-1.387-1.333-1.756-1.333-1.756-1.089-.744.084-.729.084-.729 1.205.084 1.84 1.235 1.84 1.235 1.07 1.834 2.807 1.304 3.492.997.108-.775.42-1.305.762-1.605-2.665-.305-5.466-1.333-5.466-5.931 0-1.311.468-2.382 1.236-3.222-.123-.303-.536-1.527.117-3.176 0 0 1.008-.322 3.3 1.23a11.5 11.5 0 0 1 3-.404c1.02.005 2.045.138 3 .404 2.292-1.552 3.297-1.23 3.297-1.23.655 1.649.242 2.873.12 3.176.77.84 1.234 1.911 1.234 3.222 0 4.61-2.807 5.624-5.48 5.921.431.372.816 1.102.816 2.222 0 1.606-.015 2.898-.015 3.293 0 .322.216.694.825.576C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" data-v-7514f21b></path></svg>ArtificialIntellicat/composite-risk-explorer-gmi-wri</a></p></div><p class="text-center text-gray-800 text-sm mb-6 mt-6" data-v-7514f21b> Sources: <a href="https://gmi.bicc.de/ranking-table" class="underline" target="_blank" data-v-7514f21b>BICC</a>, <a href="https://www.weltrisikobericht.de" class="underline" target="_blank" data-v-7514f21b>WorldRiskReport</a></p>',2))]))}},fe=q(pe,[["__scopeId","data-v-7514f21b"]]);export{fe as default};
